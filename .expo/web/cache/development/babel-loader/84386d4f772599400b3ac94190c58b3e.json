{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _utils = require(\"../../utils\");\n\nvar Query = function () {\n  function Query(ref, existingModifiers) {\n    (0, _classCallCheck2.default)(this, Query);\n    this.modifiers = existingModifiers ? (0, _toConsumableArray2.default)(existingModifiers) : [];\n    this._reference = ref;\n  }\n\n  (0, _createClass2.default)(Query, [{\n    key: \"orderBy\",\n    value: function orderBy(name, key) {\n      this.modifiers.push({\n        id: \"orderBy-\" + name + \":\" + (key || ''),\n        type: 'orderBy',\n        name: name,\n        key: key\n      });\n      return this._reference;\n    }\n  }, {\n    key: \"limit\",\n    value: function limit(name, _limit) {\n      this.modifiers.push({\n        id: \"limit-\" + name + \":\" + _limit,\n        type: 'limit',\n        name: name,\n        limit: _limit\n      });\n      return this._reference;\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(name, value, key) {\n      this.modifiers.push({\n        id: \"filter-\" + name + \":\" + (0, _utils.objectToUniqueId)(value) + \":\" + (key || ''),\n        type: 'filter',\n        name: name,\n        value: value,\n        valueType: typeof value,\n        key: key\n      });\n      return this._reference;\n    }\n  }, {\n    key: \"getModifiers\",\n    value: function getModifiers() {\n      return (0, _toConsumableArray2.default)(this.modifiers);\n    }\n  }, {\n    key: \"queryIdentifier\",\n    value: function queryIdentifier() {\n      var sortedModifiers = this.getModifiers().sort(function (a, b) {\n        if (a.id < b.id) return -1;\n        if (a.id > b.id) return 1;\n        return 0;\n      });\n      var key = '{';\n\n      for (var i = 0; i < sortedModifiers.length; i++) {\n        if (i !== 0) key += ',';\n        key += sortedModifiers[i].id;\n      }\n\n      key += '}';\n      return key;\n    }\n  }]);\n  return Query;\n}();\n\nexports.default = Query;","map":{"version":3,"sources":["/Users/alheresh/trend-mobile/my-trend-new/node_modules/react-native-firebase/dist/modules/database/Query.js"],"names":["Query","ref","existingModifiers","modifiers","_reference","name","key","push","id","type","limit","value","valueType","sortedModifiers","getModifiers","sort","a","b","i","length"],"mappings":";;;;;;;;;;;;;AAIA;;IAMqBA,K;AACnB,iBAAYC,GAAZ,EAAiBC,iBAAjB,EAAoC;AAAA;AAClC,SAAKC,SAAL,GAAiBD,iBAAiB,oCAAOA,iBAAP,IAA4B,EAA9D;AACA,SAAKE,UAAL,GAAkBH,GAAlB;AACD;;;;WASD,iBAAQI,IAAR,EAAcC,GAAd,EAAmB;AACjB,WAAKH,SAAL,CAAeI,IAAf,CAAoB;AAClBC,QAAAA,EAAE,eAAaH,IAAb,UAAqBC,GAAG,IAAI,EAA5B,CADgB;AAElBG,QAAAA,IAAI,EAAE,SAFY;AAGlBJ,QAAAA,IAAI,EAAJA,IAHkB;AAIlBC,QAAAA,GAAG,EAAHA;AAJkB,OAApB;AAMA,aAAO,KAAKF,UAAZ;AACD;;;WASD,eAAMC,IAAN,EAAYK,MAAZ,EAAmB;AACjB,WAAKP,SAAL,CAAeI,IAAf,CAAoB;AAClBC,QAAAA,EAAE,aAAWH,IAAX,SAAmBK,MADH;AAElBD,QAAAA,IAAI,EAAE,OAFY;AAGlBJ,QAAAA,IAAI,EAAJA,IAHkB;AAIlBK,QAAAA,KAAK,EAALA;AAJkB,OAApB;AAMA,aAAO,KAAKN,UAAZ;AACD;;;WAUD,gBAAOC,IAAP,EAAaM,KAAb,EAAoBL,GAApB,EAAyB;AACvB,WAAKH,SAAL,CAAeI,IAAf,CAAoB;AAClBC,QAAAA,EAAE,cAAYH,IAAZ,SAAoB,6BAAiBM,KAAjB,CAApB,UAA+CL,GAAG,IAAI,EAAtD,CADgB;AAElBG,QAAAA,IAAI,EAAE,QAFY;AAGlBJ,QAAAA,IAAI,EAAJA,IAHkB;AAIlBM,QAAAA,KAAK,EAALA,KAJkB;AAKlBC,QAAAA,SAAS,EAAE,OAAOD,KALA;AAMlBL,QAAAA,GAAG,EAAHA;AANkB,OAApB;AAQA,aAAO,KAAKF,UAAZ;AACD;;;WAOD,wBAAe;AACb,8CAAW,KAAKD,SAAhB;AACD;;;WAOD,2BAAkB;AAEhB,UAAMU,eAAe,GAAG,KAAKC,YAAL,GAAoBC,IAApB,CAAyB,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACzD,YAAID,CAAC,CAACR,EAAF,GAAOS,CAAC,CAACT,EAAb,EAAiB,OAAO,CAAC,CAAR;AACjB,YAAIQ,CAAC,CAACR,EAAF,GAAOS,CAAC,CAACT,EAAb,EAAiB,OAAO,CAAP;AACjB,eAAO,CAAP;AACD,OAJuB,CAAxB;AAMA,UAAIF,GAAG,GAAG,GAAV;;AAEA,WAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,eAAe,CAACM,MAApC,EAA4CD,CAAC,EAA7C,EAAiD;AAC/C,YAAIA,CAAC,KAAK,CAAV,EAAaZ,GAAG,IAAI,GAAP;AACbA,QAAAA,GAAG,IAAIO,eAAe,CAACK,CAAD,CAAf,CAAmBV,EAA1B;AACD;;AAEDF,MAAAA,GAAG,IAAI,GAAP;AACA,aAAOA,GAAP;AACD","sourcesContent":["/**\n * \n * Query representation wrapper\n */\nimport { objectToUniqueId } from '../../utils';\n// todo doc methods\n\n/**\n * @class Query\n */\nexport default class Query {\n  constructor(ref, existingModifiers) {\n    this.modifiers = existingModifiers ? [...existingModifiers] : [];\n    this._reference = ref;\n  }\n  /**\n   *\n   * @param name\n   * @param key\n   * @return {Reference|*}\n   */\n\n\n  orderBy(name, key) {\n    this.modifiers.push({\n      id: `orderBy-${name}:${key || ''}`,\n      type: 'orderBy',\n      name,\n      key\n    });\n    return this._reference;\n  }\n  /**\n   *\n   * @param name\n   * @param limit\n   * @return {Reference|*}\n   */\n\n\n  limit(name, limit) {\n    this.modifiers.push({\n      id: `limit-${name}:${limit}`,\n      type: 'limit',\n      name,\n      limit\n    });\n    return this._reference;\n  }\n  /**\n   *\n   * @param name\n   * @param value\n   * @param key\n   * @return {Reference|*}\n   */\n\n\n  filter(name, value, key) {\n    this.modifiers.push({\n      id: `filter-${name}:${objectToUniqueId(value)}:${key || ''}`,\n      type: 'filter',\n      name,\n      value,\n      valueType: typeof value,\n      key\n    });\n    return this._reference;\n  }\n  /**\n   *\n   * @return {[*]}\n   */\n\n\n  getModifiers() {\n    return [...this.modifiers];\n  }\n  /**\n   *\n   * @return {*}\n   */\n\n\n  queryIdentifier() {\n    // sort modifiers to enforce ordering\n    const sortedModifiers = this.getModifiers().sort((a, b) => {\n      if (a.id < b.id) return -1;\n      if (a.id > b.id) return 1;\n      return 0;\n    }); // Convert modifiers to unique key\n\n    let key = '{';\n\n    for (let i = 0; i < sortedModifiers.length; i++) {\n      if (i !== 0) key += ',';\n      key += sortedModifiers[i].id;\n    }\n\n    key += '}';\n    return key;\n  }\n\n}"]},"metadata":{},"sourceType":"script"}