{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _SnapshotError = _interopRequireDefault(require(\"./SnapshotError\"));\n\nvar _DocumentSnapshot = _interopRequireDefault(require(\"./DocumentSnapshot\"));\n\nvar _CollectionReference = _interopRequireDefault(require(\"./CollectionReference\"));\n\nvar _utils = require(\"./utils\");\n\nvar _serialize = require(\"./utils/serialize\");\n\nvar _native = require(\"../../utils/native\");\n\nvar _utils2 = require(\"../../utils\");\n\nvar _events = require(\"../../utils/events\");\n\nvar DocumentReference = function () {\n  function DocumentReference(firestore, documentPath) {\n    (0, _classCallCheck2.default)(this, DocumentReference);\n    this._documentPath = documentPath;\n    this._firestore = firestore;\n  }\n\n  (0, _createClass2.default)(DocumentReference, [{\n    key: \"firestore\",\n    get: function get() {\n      return this._firestore;\n    }\n  }, {\n    key: \"id\",\n    get: function get() {\n      return this._documentPath.id;\n    }\n  }, {\n    key: \"parent\",\n    get: function get() {\n      var parentPath = this._documentPath.parent();\n\n      return new _CollectionReference.default(this._firestore, parentPath);\n    }\n  }, {\n    key: \"path\",\n    get: function get() {\n      return this._documentPath.relativeName;\n    }\n  }, {\n    key: \"isEqual\",\n    value: function isEqual(otherDocumentReference) {\n      if (!(otherDocumentReference instanceof DocumentReference)) {\n        throw new Error('firebase.firestore.DocumentReference.isEqual(*) expects an instance of DocumentReference.');\n      }\n\n      if (this.path !== otherDocumentReference.path) return false;\n\n      if (this._firestore.app.name !== otherDocumentReference._firestore.app.name) {\n        return false;\n      }\n\n      if (this._firestore.app.options.projectId !== otherDocumentReference._firestore.app.options.projectId) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"collection\",\n    value: function collection(collectionPath) {\n      var path = this._documentPath.child(collectionPath);\n\n      if (!path.isCollection) {\n        throw new Error('Argument \"collectionPath\" must point to a collection.');\n      }\n\n      return new _CollectionReference.default(this._firestore, path);\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      return (0, _native.getNativeModule)(this._firestore).documentDelete(this.path);\n    }\n  }, {\n    key: \"get\",\n    value: function get(options) {\n      var _this = this;\n\n      if (options) {\n        if (!(0, _utils2.isObject)(options)) {\n          return Promise.reject(new Error('DocumentReference.get failed: First argument must be an object.'));\n        }\n\n        if (options.source && options.source !== 'default' && options.source !== 'server' && options.source !== 'cache') {\n          return Promise.reject(new Error('DocumentReference.get failed: GetOptions.source must be one of `default`, `server` or `cache`.'));\n        }\n      }\n\n      return (0, _native.getNativeModule)(this._firestore).documentGet(this.path, options).then(function (result) {\n        return new _DocumentSnapshot.default(_this._firestore, result);\n      });\n    }\n  }, {\n    key: \"onSnapshot\",\n    value: function onSnapshot(optionsOrObserverOrOnNext, observerOrOnNextOrOnError, onError) {\n      var _this2 = this;\n\n      var observer;\n      var docListenOptions = {};\n\n      if ((0, _utils2.isFunction)(optionsOrObserverOrOnNext)) {\n        if (observerOrOnNextOrOnError && !(0, _utils2.isFunction)(observerOrOnNextOrOnError)) {\n          throw new Error('DocumentReference.onSnapshot failed: Second argument must be a valid function.');\n        }\n\n        observer = {\n          next: optionsOrObserverOrOnNext,\n          error: observerOrOnNextOrOnError\n        };\n      } else if (optionsOrObserverOrOnNext && (0, _utils2.isObject)(optionsOrObserverOrOnNext)) {\n        if (optionsOrObserverOrOnNext.next) {\n          if ((0, _utils2.isFunction)(optionsOrObserverOrOnNext.next)) {\n            if (optionsOrObserverOrOnNext.error && !(0, _utils2.isFunction)(optionsOrObserverOrOnNext.error)) {\n              throw new Error('DocumentReference.onSnapshot failed: Observer.error must be a valid function.');\n            }\n\n            observer = {\n              next: optionsOrObserverOrOnNext.next,\n              error: optionsOrObserverOrOnNext.error\n            };\n          } else {\n            throw new Error('DocumentReference.onSnapshot failed: Observer.next must be a valid function.');\n          }\n        } else if (Object.prototype.hasOwnProperty.call(optionsOrObserverOrOnNext, 'includeMetadataChanges')) {\n          docListenOptions = optionsOrObserverOrOnNext;\n\n          if ((0, _utils2.isFunction)(observerOrOnNextOrOnError)) {\n            if (onError && !(0, _utils2.isFunction)(onError)) {\n              throw new Error('DocumentReference.onSnapshot failed: Third argument must be a valid function.');\n            }\n\n            observer = {\n              next: observerOrOnNextOrOnError,\n              error: onError\n            };\n          } else if (observerOrOnNextOrOnError && (0, _utils2.isObject)(observerOrOnNextOrOnError) && observerOrOnNextOrOnError.next) {\n            if ((0, _utils2.isFunction)(observerOrOnNextOrOnError.next)) {\n              if (observerOrOnNextOrOnError.error && !(0, _utils2.isFunction)(observerOrOnNextOrOnError.error)) {\n                throw new Error('DocumentReference.onSnapshot failed: Observer.error must be a valid function.');\n              }\n\n              observer = {\n                next: observerOrOnNextOrOnError.next,\n                error: observerOrOnNextOrOnError.error\n              };\n            } else {\n              throw new Error('DocumentReference.onSnapshot failed: Observer.next must be a valid function.');\n            }\n          } else {\n            throw new Error('DocumentReference.onSnapshot failed: Second argument must be a function or observer.');\n          }\n        } else {\n          throw new Error('DocumentReference.onSnapshot failed: First argument must be a function, observer or options.');\n        }\n      } else {\n        throw new Error('DocumentReference.onSnapshot failed: Called with invalid arguments.');\n      }\n\n      var listenerId = (0, _utils2.firestoreAutoId)();\n\n      var listener = function listener(nativeDocumentSnapshot) {\n        var documentSnapshot = new _DocumentSnapshot.default(_this2.firestore, nativeDocumentSnapshot);\n        observer.next(documentSnapshot);\n      };\n\n      var snapshotSubscription = _events.SharedEventEmitter.addListener((0, _events.getAppEventName)(this._firestore, \"onDocumentSnapshot:\" + listenerId), listener);\n\n      var unsubscribe;\n\n      var errorSubscription = _events.SharedEventEmitter.addListener((0, _events.getAppEventName)(this._firestore, \"onDocumentSnapshotError:\" + listenerId), function (e) {\n        if (unsubscribe) unsubscribe();\n        var error = new _SnapshotError.default(e);\n        if (observer.error) observer.error(error);else _this2.firestore.log.error(error);\n      });\n\n      (0, _native.getNativeModule)(this._firestore).documentOnSnapshot(this.path, listenerId, docListenOptions);\n\n      unsubscribe = function unsubscribe() {\n        snapshotSubscription.remove();\n        errorSubscription.remove();\n        (0, _native.getNativeModule)(_this2._firestore).documentOffSnapshot(_this2.path, listenerId);\n      };\n\n      return unsubscribe;\n    }\n  }, {\n    key: \"set\",\n    value: function set(data, options) {\n      var nativeData = (0, _serialize.buildNativeMap)(data);\n      return (0, _native.getNativeModule)(this._firestore).documentSet(this.path, nativeData, options);\n    }\n  }, {\n    key: \"update\",\n    value: function update() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      var data = (0, _utils.parseUpdateArgs)(args, 'DocumentReference.update');\n      var nativeData = (0, _serialize.buildNativeMap)(data);\n      return (0, _native.getNativeModule)(this._firestore).documentUpdate(this.path, nativeData);\n    }\n  }]);\n  return DocumentReference;\n}();\n\nexports.default = DocumentReference;","map":{"version":3,"sources":["/Users/alheresh/trend-mobile/my-trend-new/node_modules/react-native-firebase/dist/modules/firestore/DocumentReference.js"],"names":["DocumentReference","firestore","documentPath","_documentPath","_firestore","id","parentPath","parent","CollectionReference","relativeName","otherDocumentReference","Error","path","app","name","options","projectId","collectionPath","child","isCollection","documentDelete","Promise","reject","source","documentGet","then","result","DocumentSnapshot","optionsOrObserverOrOnNext","observerOrOnNextOrOnError","onError","observer","docListenOptions","next","error","Object","prototype","hasOwnProperty","call","listenerId","listener","nativeDocumentSnapshot","documentSnapshot","snapshotSubscription","SharedEventEmitter","addListener","unsubscribe","errorSubscription","e","SnapshotError","log","documentOnSnapshot","remove","documentOffSnapshot","data","nativeData","documentSet","args","documentUpdate"],"mappings":"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","sourcesContent":["/**\n * \n * DocumentReference representation wrapper\n */\nimport SnapshotError from './SnapshotError';\nimport DocumentSnapshot from './DocumentSnapshot';\nimport CollectionReference from './CollectionReference';\nimport { parseUpdateArgs } from './utils';\nimport { buildNativeMap } from './utils/serialize';\nimport { getNativeModule } from '../../utils/native';\nimport { firestoreAutoId, isFunction, isObject } from '../../utils';\nimport { getAppEventName, SharedEventEmitter } from '../../utils/events';\n\n/**\n * @class DocumentReference\n */\nexport default class DocumentReference {\n  constructor(firestore, documentPath) {\n    this._documentPath = documentPath;\n    this._firestore = firestore;\n  }\n\n  get firestore() {\n    return this._firestore;\n  }\n\n  get id() {\n    return this._documentPath.id;\n  }\n\n  get parent() {\n    const parentPath = this._documentPath.parent(); // $FlowExpectedError: parentPath can never be null\n\n\n    return new CollectionReference(this._firestore, parentPath);\n  }\n\n  get path() {\n    return this._documentPath.relativeName;\n  }\n\n  isEqual(otherDocumentReference) {\n    if (!(otherDocumentReference instanceof DocumentReference)) {\n      throw new Error('firebase.firestore.DocumentReference.isEqual(*) expects an instance of DocumentReference.');\n    } // check paths match\n\n\n    if (this.path !== otherDocumentReference.path) return false; // check same firestore app name\n\n    if (this._firestore.app.name !== otherDocumentReference._firestore.app.name) {\n      return false;\n    } // check same firestore app projectId\n    // noinspection RedundantIfStatementJS\n\n\n    if (this._firestore.app.options.projectId !== otherDocumentReference._firestore.app.options.projectId) {\n      return false;\n    }\n\n    return true;\n  }\n\n  collection(collectionPath) {\n    const path = this._documentPath.child(collectionPath);\n\n    if (!path.isCollection) {\n      throw new Error('Argument \"collectionPath\" must point to a collection.');\n    }\n\n    return new CollectionReference(this._firestore, path);\n  }\n\n  delete() {\n    return getNativeModule(this._firestore).documentDelete(this.path);\n  }\n\n  get(options) {\n    if (options) {\n      if (!isObject(options)) {\n        return Promise.reject(new Error('DocumentReference.get failed: First argument must be an object.'));\n      }\n\n      if (options.source && options.source !== 'default' && options.source !== 'server' && options.source !== 'cache') {\n        return Promise.reject(new Error('DocumentReference.get failed: GetOptions.source must be one of `default`, `server` or `cache`.'));\n      }\n    }\n\n    return getNativeModule(this._firestore).documentGet(this.path, options).then(result => new DocumentSnapshot(this._firestore, result));\n  }\n\n  onSnapshot(optionsOrObserverOrOnNext, observerOrOnNextOrOnError, onError) {\n    let observer;\n    let docListenOptions = {}; // Called with: onNext, ?onError\n\n    if (isFunction(optionsOrObserverOrOnNext)) {\n      if (observerOrOnNextOrOnError && !isFunction(observerOrOnNextOrOnError)) {\n        throw new Error('DocumentReference.onSnapshot failed: Second argument must be a valid function.');\n      } // $FlowExpectedError: Not coping with the overloaded method signature\n\n\n      observer = {\n        next: optionsOrObserverOrOnNext,\n        error: observerOrOnNextOrOnError\n      };\n    } else if (optionsOrObserverOrOnNext && isObject(optionsOrObserverOrOnNext)) {\n      // Called with: Observer\n      if (optionsOrObserverOrOnNext.next) {\n        if (isFunction(optionsOrObserverOrOnNext.next)) {\n          if (optionsOrObserverOrOnNext.error && !isFunction(optionsOrObserverOrOnNext.error)) {\n            throw new Error('DocumentReference.onSnapshot failed: Observer.error must be a valid function.');\n          } // $FlowExpectedError: Not coping with the overloaded method signature\n\n\n          observer = {\n            next: optionsOrObserverOrOnNext.next,\n            error: optionsOrObserverOrOnNext.error\n          };\n        } else {\n          throw new Error('DocumentReference.onSnapshot failed: Observer.next must be a valid function.');\n        }\n      } else if (Object.prototype.hasOwnProperty.call(optionsOrObserverOrOnNext, 'includeMetadataChanges')) {\n        docListenOptions = optionsOrObserverOrOnNext; // Called with: Options, onNext, ?onError\n\n        if (isFunction(observerOrOnNextOrOnError)) {\n          if (onError && !isFunction(onError)) {\n            throw new Error('DocumentReference.onSnapshot failed: Third argument must be a valid function.');\n          } // $FlowExpectedError: Not coping with the overloaded method signature\n\n\n          observer = {\n            next: observerOrOnNextOrOnError,\n            error: onError\n          }; // Called with Options, Observer\n        } else if (observerOrOnNextOrOnError && isObject(observerOrOnNextOrOnError) && observerOrOnNextOrOnError.next) {\n          if (isFunction(observerOrOnNextOrOnError.next)) {\n            if (observerOrOnNextOrOnError.error && !isFunction(observerOrOnNextOrOnError.error)) {\n              throw new Error('DocumentReference.onSnapshot failed: Observer.error must be a valid function.');\n            }\n\n            observer = {\n              next: observerOrOnNextOrOnError.next,\n              error: observerOrOnNextOrOnError.error\n            };\n          } else {\n            throw new Error('DocumentReference.onSnapshot failed: Observer.next must be a valid function.');\n          }\n        } else {\n          throw new Error('DocumentReference.onSnapshot failed: Second argument must be a function or observer.');\n        }\n      } else {\n        throw new Error('DocumentReference.onSnapshot failed: First argument must be a function, observer or options.');\n      }\n    } else {\n      throw new Error('DocumentReference.onSnapshot failed: Called with invalid arguments.');\n    }\n\n    const listenerId = firestoreAutoId();\n\n    const listener = nativeDocumentSnapshot => {\n      const documentSnapshot = new DocumentSnapshot(this.firestore, nativeDocumentSnapshot);\n      observer.next(documentSnapshot);\n    }; // Listen to snapshot events\n\n\n    const snapshotSubscription = SharedEventEmitter.addListener(getAppEventName(this._firestore, `onDocumentSnapshot:${listenerId}`), listener);\n    let unsubscribe; // listen for snapshot error events\n\n    const errorSubscription = SharedEventEmitter.addListener(getAppEventName(this._firestore, `onDocumentSnapshotError:${listenerId}`), e => {\n      if (unsubscribe) unsubscribe();\n      const error = new SnapshotError(e);\n      if (observer.error) observer.error(error);else this.firestore.log.error(error);\n    }); // Add the native listener\n\n    getNativeModule(this._firestore).documentOnSnapshot(this.path, listenerId, docListenOptions); // return an unsubscribe method\n\n    unsubscribe = () => {\n      snapshotSubscription.remove();\n      errorSubscription.remove(); // cancel native listener\n\n      getNativeModule(this._firestore).documentOffSnapshot(this.path, listenerId);\n    };\n\n    return unsubscribe;\n  }\n\n  set(data, options) {\n    const nativeData = buildNativeMap(data);\n    return getNativeModule(this._firestore).documentSet(this.path, nativeData, options);\n  }\n\n  update(...args) {\n    const data = parseUpdateArgs(args, 'DocumentReference.update');\n    const nativeData = buildNativeMap(data);\n    return getNativeModule(this._firestore).documentUpdate(this.path, nativeData);\n  }\n\n}"]},"metadata":{},"sourceType":"script"}